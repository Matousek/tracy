<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Tracy by nette</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Tracy</h1>
        <h2>PHP debugger</h2>
        <a href="https://github.com/nette/tracy" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
        
<p>Tracy library is a useful PHP everyday programmer's helper. It helps you to:</p>

<ul>
<li>quickly detect and correct errors</li>
<li>log errors</li>
<li>dump variables</li>
<li>measure the time</li>
</ul><p>PHP is a perfect language for making hardly detectable errors because it gives a great flexibility to programmers. Tracy\Debugger is more valuable because of that. It is a ultimate tool among the diagnostic ones.
If you are meeting Tracy the first time, believe me, your life starts to be divided one before the Tracy and the one with her.
Welcome to the good part!</p>

<p>The best way how to install Tracy is to download a latest package from <a href="http://nette.github.io/tracy/">http://nette.github.io/tracy/</a> or use a Composer:</p>

<pre><code>php composer.phar require tracy/tracy
</code></pre>

<p>It is easy to activate Tracy. Preferably immediately after libraries loading (via Composer or <code>require 'src/tracy.php'</code>) add code:</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">Tracy\Debugger</span><span class="p">;</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">enable</span><span class="p">();</span>
</pre></div>

<p>The first thing you notice on the web site is a Debugger Bar.</p>

<h2>
<a name="debugger-bar" class="anchor" href="#debugger-bar"><span class="octicon octicon-link"></span></a>Debugger Bar</h2>

<p>The Debugger Bar is a floating panel. It is displayed in the bottom right corner of a page. You can move it by the mouse. It will remember its position after the page reloading.</p>

<p><a href="https://github-camo.global.ssl.fastly.net/0832d7a7be4471db21eeaebae20f8ac69d094178/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f64656275676765722d6261722e706e67" target="_blank"><img src="https://github-camo.global.ssl.fastly.net/0832d7a7be4471db21eeaebae20f8ac69d094178/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f64656275676765722d6261722e706e67" alt="Debugger-Bar" style="max-width:100%;"></a></p>

<p>You can add other useful panels into the Debugger Bar. A lot of them can be found at <a href="http://addons.nette.org">http://addons.nette.org</a>.</p>

<h2>
<a name="visualization-of-errors-and-exceptions" class="anchor" href="#visualization-of-errors-and-exceptions"><span class="octicon octicon-link"></span></a>Visualization of errors and exceptions</h2>

<p>Surely, you know how PHP reports errors: there is something like this in the page source code:</p>

<pre lang="pre"><code>&lt;b&gt;Parse error&lt;/b&gt;:  syntax error, unexpected T_STRING in &lt;b&gt;DashboardPresenter.php&lt;/b&gt; on line &lt;b&gt;8&lt;/b&gt;
</code></pre>

<p>or uncaught exception:</p>

<pre lang="pre"><code>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught exception 'MemberAccessException' with message 'Call to undefined method Nette\Http\User::isLogedIn().' in D:\Web\Nette.web\libs\Nette\ObjectMixin.php:69
Stack trace:
#0 D:\Web\Nette.web\libs\Nette\Object.php(80): ObjectMixin::call(Object(User), 'isLogedIn', Array)
#1 [internal function]: Object-&amp;gt;__call('isLogedIn', Array)
#2 D:\Web\cd-collection\app\presenters\DashboardPresenter.php(12): User-&amp;gt;isLogedIn()
#3 D:\Web\Nette.web\libs\Nette\Application\Presenter.php(154): DashboardPresenter-&amp;gt;startup()
#4 D:\Web\Nette.web\libs\Nette\Application\Application.php(148): Presenter-&amp;gt;run(Object(PresenterRequest))
#5 D:\Web\cd-collection\app\bootstrap.php(54): Application-&amp;gt;run()
#6 D:\Web\cd-collection\index.php(13): require('D:\Web\cd-colle...')
#7 {main}
  thrown in &lt;b&gt;D:\Web\Nette.web\libs\Nette\ObjectMixin.php&lt;/b&gt; on line &lt;b&gt;69&lt;/b&gt;
</code></pre>

<p>It is not so easy to navigate throw this output. If you enable the Tracy, errors or exceptions are displayed completely in a different form:</p>

<p><a href="http://nette.github.io/tracy/images/nette-exception.html"><img src="https://github-camo.global.ssl.fastly.net/c7950779ea92a1c9aa8715f324d4b0b70a375665/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f6465627567676572312e706e67" alt="Uncaught exception rendered by Tracy" style="max-width:100%;"></a></p>

<p>The error message literally screams. You can see a part of the source code with the highlighted line where the error occurred. A message <strong>Call to undefined method Nette\Http\User::isLogedIn()</strong> clearly explains an error. The entire site is interactive. You can click through for more details. Try it.</p>

<p>And you know what? A fatal errors are captured and displayed in the same way. No need to install any extension.</p>

<p><a href="http://nette.github.io/tracy/images/nette-error.html"><img src="https://github-camo.global.ssl.fastly.net/b3b1b68593eb016bd0dced76f4194f9e5b945049/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f6465627567676572322e706e67" alt="Fatal error rendered by Tracy" style="max-width:100%;"></a></p>

<p>Errors like a typo in a variable name or an attempt to open a nonexistent file generate reports of E_NOTICE or E_WARNING level. These can be easily overlooked and/or can be completly hidden in a web page graphic layout. Let Tracy to manage them:</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="nv">$strictMode</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
</pre></div>

<p>You can also change the nesting depth by <code>Debugger::$maxDepth</code> and displayed strings length by <code>Debugger::$maxLen</code>. Naturally, lower values accelerates Tracy rendering.</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="nv">$maxDepth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// default: 3</span>
<span class="nx">Debugger</span><span class="o">::</span><span class="nv">$maxLen</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="c1">// default: 150</span>
</pre></div>

<h2>
<a name="production-mode-and-error-logging" class="anchor" href="#production-mode-and-error-logging"><span class="octicon octicon-link"></span></a>Production mode and error logging</h2>

<p>As you can see, Tracy is quite eloquent. It is appreciated in a development environment, but on a production server it would cause disaster. There cannot be listed any debugging information. Therefore Tracy has an environment autodetection and logging functionality. Instead of showing self, Tracy stores information into log file and shows a server error with user-comprehensible message to visitor:</p>

<p><a href="https://github-camo.global.ssl.fastly.net/4ed76616b84944244e24188b2ae6775ee97d6669/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f6465627567676572332e706e67" target="_blank"><img src="https://github-camo.global.ssl.fastly.net/4ed76616b84944244e24188b2ae6775ee97d6669/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f6465627567676572332e706e67" alt="Server Error 500" style="max-width:100%;"></a></p>

<p>An output mode suppresses all debugging information which are sent out via <code>Debugger::dump()</code> or <code>Debugger::fireLog()</code>, and of course all error messages generated by PHP. So, if you forget <code>Debugger::dump($obj)</code> in the source code, you do not have to worry about it on a production server. Nothing will be listed.</p>

<p>The output mode is switched by the first parameter of <code>Debugger::enable()</code>. You can specify either a constant <code>Debugger::PRODUCTION</code> or <code>Debugger::DEVELOPMENT</code>.</p>

<p>If it is not specified, the default value <code>Debugger::DETECT</code> is used. In this case the system detects a server by IP address. The production mode is choosed if an application is accessed via public IP address. A local IP address leads to development mode. It is not necessary to set the mode in most cases. The mode is correctly recognized when you are launching the application on your local server or in production.</p>

<p>In the production mode, Tracy automatically capture all errors and exceptions into a text log. Unless you specify otherwise, it will be a set of log/error.log. This error logging is extremely useful. Imagine, that all users of your application are actually betatesters. They are doing cutting-edge work for free when hunting bugs and you would be silly if you threw away their valuable reports to a recycle bin unnoticed.</p>

<p>If you need a own messages logging or you caught an exception, use the method <code>log()</code>:</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="na">log</span><span class="p">(</span><span class="s1">'Unexpected error'</span><span class="p">);</span> <span class="c1">// text message</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="nx">criticalOperation</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Debugger</span><span class="o">::</span><span class="na">log</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span> <span class="c1">// log exception</span>
    <span class="c1">// or</span>
    <span class="nx">Debugger</span><span class="o">::</span><span class="na">log</span><span class="p">(</span><span class="nv">$e</span><span class="p">,</span> <span class="nx">Debugger</span><span class="o">::</span><span class="na">ERROR</span><span class="p">)</span> <span class="c1">// sends also an email notification</span>
<span class="p">}</span>
</pre></div>

<p>A directory for errors logging can be set by the second parameter of enable() method:</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="na">enable</span><span class="p">(</span><span class="nx">Debugger</span><span class="o">::</span><span class="na">DETECT</span><span class="p">,</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/mylog'</span><span class="p">);</span>
</pre></div>

<p>For a real professional is the error log a key source of information and he wants to be noticed about any new error immediately. Tracy helps him. She is capable to send an email on every new error record. The variable $email identify where to send the e-mails:</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="nv">$email</span> <span class="o">=</span> <span class="s1">'admin@example.com'</span><span class="p">;</span>
</pre></div>

<p>To protect your e-mail box from flood, Tracy sends <strong>the only one message</strong> and creates a file <code>email-sent</code>. When developer receives an e-mail notification, he checks the log, corrects application and deletes the monitoring file. It activates the e-mails sending back.</p>

<h2>
<a name="variables-dumping" class="anchor" href="#variables-dumping"><span class="octicon octicon-link"></span></a>Variables dumping</h2>

<p>Each debugging developer is a good friend with the function <code>var_dump</code> which lists a content of a variable in detail. Unfortunately, the output is without HTML formatting and decants dump into a single line of HTML code. Not to mention an context escaping. It is necessary replace the <code>var_dump</code> by a handier function. That is just <code>Debugger::dump()</code>.</p>

<div class="highlight highlight-php"><pre><span class="nv">$arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">20.2</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="s1">'hello'</span><span class="p">);</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">dump</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span>
<span class="c1">// including namespace Tracy\Debugger::dump($arr);</span>
</pre></div>

<p>generates the output:</p>

<pre lang="pre"><code>&lt;pre&gt;&lt;span style="color:gray"&gt;array&lt;/span&gt;(5) {
  [0] =&gt; &lt;span style="color:gray"&gt;int&lt;/span&gt;(10)
  [1] =&gt; &lt;span style="color:gray"&gt;float&lt;/span&gt;(20.2)
  [2] =&gt; &lt;span style="color:gray"&gt;bool&lt;/span&gt;(true)
  [3] =&gt; &lt;span style="color:gray"&gt;NULL&lt;/span&gt;
  [4] =&gt; &lt;span style="color:gray"&gt;string&lt;/span&gt;(5) "hello"
}
&lt;/pre&gt;
</code></pre>

<h2>
<a name="timing" class="anchor" href="#timing"><span class="octicon octicon-link"></span></a>Timing</h2>

<p>An another useful tool is a debugger stopwatch with a precision of microseconds:</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">();</span>

<span class="c1">// sweet dreams my cherrie</span>
<span class="nb">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="nv">$elapsed</span> <span class="o">=</span> <span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">();</span>
<span class="c1">// $elapsed = 2</span>
</pre></div>

<p>Multiple measurements can be achieved by an optional parameter.</p>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">(</span><span class="s1">'page-generating'</span><span class="p">);</span>
<span class="c1">// some code</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">(</span><span class="s1">'rss-generating'</span><span class="p">);</span>
<span class="c1">// some code</span>

<span class="nv">$rssElapsed</span> <span class="o">=</span> <span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">(</span><span class="s1">'rss-generating'</span><span class="p">);</span>
<span class="nv">$pageElapsed</span> <span class="o">=</span> <span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">(</span><span class="s1">'page-generating'</span><span class="p">);</span>
</pre></div>

<div class="highlight highlight-php"><pre><span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">();</span> <span class="c1">// runs the timer</span>

<span class="o">...</span> <span class="c1">// some difficult operation</span>

<span class="k">echo</span> <span class="nx">Debugger</span><span class="o">::</span><span class="na">timer</span><span class="p">();</span> <span class="c1">// elapsed time in seconds</span>
</pre></div>

<h2>
<a name="firebug-and-firelogger" class="anchor" href="#firebug-and-firelogger"><span class="octicon octicon-link"></span></a>Firebug and FireLogger</h2>

<p>You cannot send debugging information to the browser window always. This applies to Ajax requests, or generating XML files to output. In such cases, you can send the messages by a separate channel into Firebug. Error, Notice and Warning levels are sent to Firebug window automatically. It is also possible to log suppressed exceptions in running application when attention to them is important.</p>

<p>How to do it?</p>

<p>1) download and run Firefox browser
2) download extension <a href="http://www.getfirebug.com">Firebug</a>
3) download extension  <a href="http://firelogger.binaryage.com">FireLogger</a>
4) restart browser, turn on Firebug (key F12) and enable network (Net) and Logger panels</p>

<p>... Open our utility panel and click on the Console. Ha!, error message has been moved there.</p>

<p>Because the Tracy\Debugger communicates with Firebug via an HTTP headers, you must call the logging function before the PHP script sends anything to the output. It is also possible to enable the output buffering and delay the output.</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">Tracy\Debugger</span><span class="p">;</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">fireLog</span><span class="p">(</span><span class="s1">'Hello World'</span><span class="p">);</span> <span class="c1">// render string into Firebug console</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">fireLog</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">);</span> <span class="c1">// or even arrays and objects</span>

<span class="nx">Debugger</span><span class="o">::</span><span class="na">fireLog</span><span class="p">(</span><span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">'Test Exception'</span><span class="p">));</span> <span class="c1">// or exceptions</span>
</pre></div>

<p>The result looks like this:</p>

<p><a href="https://github-camo.global.ssl.fastly.net/b5a68b7a6d2587920f5f4868cfb5658eff32cacb/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f666972656c6f676765722e706e67" target="_blank"><img src="https://github-camo.global.ssl.fastly.net/b5a68b7a6d2587920f5f4868cfb5658eff32cacb/687474703a2f2f6e657474652e6769746875622e696f2f74726163792f696d616765732f666972656c6f676765722e706e67" alt="FireLogger" style="max-width:100%;"></a></p>
        
        </section>

        <aside id="sidebar">
          <a href="https://github.com/nette/tracy/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/nette/tracy/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/nette/tracy"></a> is maintained by <a href="https://github.com/nette">nette</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>